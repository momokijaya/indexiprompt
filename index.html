<!DOCTYPE html>
<html lang="id" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INDEXIPRMT</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom Keyframe Animations */
        @keyframes fade-in-up {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fade-in {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* Animation Utility Classes */
        .animate-fade-in-up {
            animation: fade-in-up 0.6s ease-out forwards;
            opacity: 0;
        }
        
        .animate-fade-in {
            animation: fade-in 0.4s ease-out forwards;
            opacity: 0;
        }

        /* Custom Animation Delays */
        .animation-delay-2000 { animation-delay: 2s; }
        .animation-delay-4000 { animation-delay: 4s; }
        
        /* Custom Scrollbar Styling */
        .scrollbar-thin {
            scrollbar-width: thin;
            scrollbar-color: rgb(148 163 184) transparent; /* Light mode default for Firefox */
        }

        .dark .scrollbar-thin {
            scrollbar-color: rgb(71 85 105) transparent; /* Dark mode for Firefox */
        }

        /* Custom Scrollbar Styling for Webkit (Chrome, Safari) */
        .scrollbar-thin::-webkit-scrollbar {
            width: 4px;
        }
        .scrollbar-thin::-webkit-scrollbar-track {
            background: transparent;
        }
        .scrollbar-thin::-webkit-scrollbar-thumb {
            background-color: rgb(148 163 184); /* Light mode default */
            border-radius: 20px;
        }
        .dark .scrollbar-thin::-webkit-scrollbar-thumb {
            background-color: rgb(71 85 105); /* Dark mode */
        }

        /* Hide number input spinners */
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { 
          -webkit-appearance: none; 
          margin: 0; 
        }
        input[type=number] {
          -moz-appearance: textfield;
        }
    </style>
</head>
<body class="min-h-screen bg-gray-50 dark:bg-gradient-to-br dark:from-slate-900 dark:via-gray-900 dark:to-black text-slate-800 dark:text-slate-200 transition-colors duration-500">
    
    <!-- Animated Background Elements -->
    <div id="background-elements" class="fixed inset-0 overflow-hidden pointer-events-none"></div>
    
    <!-- Sticky Header -->
    <header id="sticky-header-container" class="sticky top-0 z-40 w-full border-b dark:border-slate-700/50 dark:bg-slate-900/75 backdrop-blur-sm"></header>

    <!-- App Container -->
    <div id="app">
        <div class="relative z-10 container mx-auto px-1 sm:px-6 lg:px-8 py-8 md:py-12">
            
            <!-- Search Bar -->
            <div id="search-bar-container"></div>

            <!-- Category Filters -->
            <div id="category-filters-container" class="flex flex-wrap justify-center gap-3 mb-16"></div>
            
            <!-- Prompt Grid -->
            <main id="prompt-grid-container" class="grid"></main>

            <!-- Pagination -->
            <div id="pagination-container" class="flex items-center justify-center gap-6 mt-16"></div>

        </div>

        <!-- Modal -->
        <div id="modal-container"></div>
        
        <!-- Toast Notification -->
        <div id="toast-container"></div>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {

    // --- DATA ---
    const promptsData = [
        {
            "id": 1,
            "image": "https://res.cloudinary.com/dsvgrmfgf/image/upload/v1758783697/1_sfxlj7.jpg",
            "prompt_id": "Foto seseorang yang mengenakan setelan hijau mint, duduk di sofa biru modern sambil memegang buku. Pencahayaan jendela yang keras menciptakan bayangan diagonal yang kuat di dinding putih di belakangnya. Gaya foto minimalis, bersih, dan canggih.",
            "prompt_en": "A photograph of a person wearing a mint green suit, sitting on a modern blue sofa while holding a book. Harsh window lighting creates a strong diagonal shadow on the white wall behind them. Minimalist, clean, and sophisticated photo style.",
            "tags_id": ["fashion", "setelan jas", "modern", "minimalis", "cahaya natural"],
            "tags_en": ["fashion", "suit", "modern", "minimalist", "natural light"],
            "category_id": "Foto & Potret",
            "category_en": "Photo & Portrait"
        },
        {
            "id": 2,
            "image": "https://res.cloudinary.com/dsvgrmfgf/image/upload/v1758783697/2_aifkuy.jpg",
            "prompt_id": "Foto hitam putih seseorang yang tampak termenung di sebuah galeri seni, mengenakan mantel hitam dengan tangan di saku. Di latar belakang, karya seni berbingkai terlihat dan orang-orang di sekitarnya kabur karena gerakan. Gaya foto candid, atmosferik, dan kontras tinggi.",
            "prompt_en": "A black and white photograph of a pensive person in an art gallery, wearing a black coat with their hands in their pockets. In the background, framed artworks are visible and people around are motion-blurred. Candid, atmospheric, and high-contrast photo style.",
            "tags_id": ["potret", "galeri seni", "hitam putih", "kontemplatif", "gerak kabur"],
            "tags_en": ["portrait", "art gallery", "black and white", "pensive", "motion blur"],
            "category_id": "Foto & Potret",
            "category_en": "Photo & Portrait"
        },
        {
            "id": 3,
            "image": "https://res.cloudinary.com/dsvgrmfgf/image/upload/v1758783697/3_ocupnp.jpg",
            "prompt_id": "Potret kecantikan close-up seseorang dengan atasan tanpa lengan berwarna putih, tersenyum lembut dengan tangan menopang dagu. Latar belakang putih bersih dengan pencahayaan high-key, menciptakan tampilan yang murni dan bercahaya. Gaya fotografi komersial yang sangat detail.",
            "prompt_en": "A close-up beauty portrait of a person in a white sleeveless top, smiling gently with their hands resting near their chin. Clean white background with high-key lighting, creating a pure and radiant look. Hyper-detailed commercial photography style.",
            "tags_id": ["potret", "kecantikan", "minimalis", "high-key", "studio"],
            "tags_en": ["portrait", "beauty", "minimalist", "high-key", "studio"],
            "category_id": "Foto & Potret",
            "category_en": "Photo & Portrait"
        },
        {
            "id": 4,
            "image": "https://res.cloudinary.com/dsvgrmfgf/image/upload/v1758783697/4_j3of32.jpg",
            "prompt_id": "Karakter 3D yang lucu mengenakan gaun bunga hitam putih dan membawa tas selempang anyaman kecil, berdiri dengan latar belakang putih. Gaya seni yang terinspirasi dari game seperti Animal Crossing, menggemaskan, dengan render 3D yang halus.",
            "prompt_en": "A cute 3D character wearing a black and white floral dress and carrying a small woven crossbody bag, standing against a plain white background. Art style inspired by games like Animal Crossing, adorable, with a smooth 3D render.",
            "tags_id": ["3d", "karakter", "imut", "render", "game"],
            "tags_en": ["3d", "character", "cute", "render", "game"],
            "category_id": "Game & Karakter",
            "category_en": "Game & Character"
        },
        {
            "id": 5,
            "image": "https://res.cloudinary.com/dsvgrmfgf/image/upload/v1758783698/5_vqyiup.jpg",
            "prompt_id": "Potret dramatis seseorang yang elegan mengenakan atasan off-the-shoulder hitam, memegang mawar merah tunggal. Subjek disinari oleh sorotan melingkar yang tajam dengan latar belakang abu-abu gelap. Gaya dengan pencahayaan sinematik, bayangan yang dalam, dan nuansa romantis.",
            "prompt_en": "A dramatic portrait of an elegant person in a black off-the-shoulder top, holding a single red rose. The subject is illuminated by a sharp circular spotlight against a dark grey background. Style with cinematic lighting, deep shadows, and a romantic mood.",
            "tags_id": ["potret", "mawar merah", "sorotan", "dramatis", "elegan"],
            "tags_en": ["portrait", "red rose", "spotlight", "dramatic", "elegant"],
            "category_id": "Foto & Potret",
            "category_en": "Photo & Portrait"
        }
    ];

    const uiStrings = {
        id: { pageTitle: "INDEXIPRMT", headerTitle: "INDEXIPRMT", headerSubtitle: "DEVELOPED BY APINAKEW", searchPlaceholder: "Cari prompt favorit Anda...", copyBtn: "Salin Prompt", copyToast: "Prompt berhasil disalin!", allCategory: "Semua", favoritesCategory: "Favorit", noResultsTitle: "Tidak ada hasil", noResultsText: "Coba kata kunci yang berbeda" },
        en: { pageTitle: "INDEXIPRMT", headerTitle: "INDEXIPRMT", headerSubtitle: "DEVELOPED BY APINAKEW", searchPlaceholder: "Search your perfect prompt...", copyBtn: "Copy Prompt", copyToast: "Prompt copied successfully!", allCategory: "All", favoritesCategory: "Favorites", noResultsTitle: "No results found", noResultsText: "Try different keywords" }
    };

    const ITEMS_PER_PAGE = 12;

    // --- STATE MANAGEMENT ---
    let state = {
        language: 'id',
        favoriteIds: [],
        searchTerm: '',
        activeCategory: '',
        toastMessage: '',
        isToastVisible: false,
        currentPage: 1,
        selectedPrompt: null,
        viewMode: 'thumbnail' // Default to thumbnail/grid view
    };

    // --- DOM ELEMENT REFERENCES ---
    const root = document.getElementById('app');
    const searchBarContainer = document.getElementById('search-bar-container');
    const categoryFiltersContainer = document.getElementById('category-filters-container');
    const promptGridContainer = document.getElementById('prompt-grid-container');
    const paginationContainer = document.getElementById('pagination-container');
    const modalContainer = document.getElementById('modal-container');
    const toastContainer = document.getElementById('toast-container');
    const backgroundElements = document.getElementById('background-elements');

    // --- HELPER FUNCTIONS ---
    function loadState() {
        const storedLang = localStorage.getItem('preferredLang');
        state.language = storedLang ? JSON.parse(storedLang) : 'id';
        
        state.favoriteIds = JSON.parse(localStorage.getItem('favoritePromptIds')) || [];
        
        const storedViewMode = localStorage.getItem('viewMode');
        state.viewMode = storedViewMode ? JSON.parse(storedViewMode) : 'thumbnail';

        state.activeCategory = uiStrings[state.language].allCategory;
    }

    function saveState(key, value) {
        localStorage.setItem(key, JSON.stringify(value));
    }
    
    function showToast(message) {
        state.isToastVisible = true;
        state.toastMessage = message;
        renderToast();
        setTimeout(() => {
            state.isToastVisible = false;
            renderToast();
        }, 3000);
    }
    
    function handleCopyToClipboard(text, strings) {
        const textArea = document.createElement("textarea");
        textArea.value = text;
        
        textArea.style.position = "fixed";
        textArea.style.top = 0;
        textArea.style.left = 0;
        textArea.style.width = "2em";
        textArea.style.height = "2em";
        textArea.style.padding = 0;
        textArea.style.border = "none";
        textArea.style.outline = "none";
        textArea.style.boxShadow = "none";
        textArea.style.background = "transparent";

        document.body.appendChild(textArea);
        textArea.focus();
        textArea.select();

        try {
            const successful = document.execCommand('copy');
            if (successful) {
                showToast(strings.copyToast);
            } else {
                 console.error('Fallback: Unable to copy');
            }
        } catch (err) {
            console.error('Fallback: Error copying', err);
        }

        document.body.removeChild(textArea);
    }

    function getFilteredPrompts() {
        const strings = uiStrings[state.language];
        
        let promptsForCategory;
        if (state.activeCategory === strings.favoritesCategory) {
            promptsForCategory = promptsData.filter(p => state.favoriteIds.includes(p.id));
        } else if (state.activeCategory !== strings.allCategory) {
            promptsForCategory = promptsData.filter(p => p[`category_${state.language}`] === state.activeCategory);
        } else {
            promptsForCategory = promptsData;
        }

        const lowerCaseSearchTerm = state.searchTerm.toLowerCase();
        return promptsForCategory.filter(p => {
            const matchesSearch = lowerCaseSearchTerm ? (
                p.prompt_id.toLowerCase().includes(lowerCaseSearchTerm) ||
                p.prompt_en.toLowerCase().includes(lowerCaseSearchTerm) ||
                p.tags_id.some(tag => tag.toLowerCase().includes(lowerCaseSearchTerm)) ||
                p.tags_en.some(tag => tag.toLowerCase().includes(lowerCaseSearchTerm))
            ) : true;

            return matchesSearch;
        });
    }

    // --- RENDER FUNCTIONS ---
    
    function renderHeader(strings) {
        const headerElement = document.getElementById('sticky-header-container');
        const idClass = state.language === 'id' ? 'bg-sky-500 text-white' : 'text-slate-400 hover:bg-slate-700 hover:text-white';
        const enClass = state.language === 'en' ? 'bg-sky-500 text-white' : 'text-slate-400 hover:bg-slate-700 hover:text-white';
        const thumbClass = state.viewMode === 'thumbnail' ? 'bg-sky-500 text-white' : 'text-slate-400';
        const detailClass = state.viewMode === 'detailed' ? 'bg-sky-500 text-white' : 'text-slate-400';

        headerElement.innerHTML = `
            <div class="container mx-auto flex h-16 items-center justify-between px-4 sm:px-6 lg:px-8">
                <div class="text-left flex items-center gap-2 sm:gap-4">
                     <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-sky-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.293 2.293a1 1 0 01-1.414 1.414L12 6.414l-2.293 2.293a1 1 0 01-1.414-1.414L10 5m0 14l2.293-2.293a1 1 0 00-1.414-1.414L12 17.586l-2.293-2.293a1 1 0 00-1.414 1.414L10 19m-4-7h4m12 0h4M5.636 5.636l1.414 1.414a1 1 0 01-1.414 1.414L4.222 7.05a1 1 0 011.414-1.414zm12.728 12.728l1.414 1.414a1 1 0 01-1.414 1.414l-1.414-1.414a1 1 0 011.414-1.414z" />
                    </svg>
                    <div>
                        <h1 class="text-lg sm:text-xl font-bold text-white">${strings.headerTitle}</h1>
                        <p class="hidden sm:block text-xs text-slate-400">${strings.headerSubtitle}</p>
                    </div>
                </div>
                <div class="flex items-center gap-2 sm:gap-4">
                     <div class="bg-slate-800/80 border border-white/10 p-1 rounded-xl shadow-md flex items-center">
                        <div class="flex space-x-1">
                            <button id="view-thumbnail-btn" class="p-2 rounded-lg transition-all duration-300 ${thumbClass}">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2h-2zM11 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2h-2z" /></svg>
                            </button>
                            <button id="view-detailed-btn" class="p-2 rounded-lg transition-all duration-300 ${detailClass}">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd" /></svg>
                            </button>
                        </div>
                    </div>
                     <div class="hidden sm:flex bg-slate-800/80 border border-white/10 p-1 rounded-xl shadow-md">
                        <div class="flex space-x-1">
                            <button id="lang-id-btn" class="px-3 py-1 text-sm font-semibold rounded-lg transition-colors duration-200 ${idClass}">ID</button>
                            <button id="lang-en-btn" class="px-3 py-1 text-sm font-semibold rounded-lg transition-colors duration-200 ${enClass}">EN</button>
                        </div>
                    </div>
                </div>
            </div>`;
            
        document.getElementById('lang-id-btn').onclick = () => {
            state.language = 'id';
            saveState('preferredLang', 'id');
            state.activeCategory = uiStrings.id.allCategory; 
            updateUI();
        };
        document.getElementById('lang-en-btn').onclick = () => {
            state.language = 'en';
            saveState('preferredLang', 'en');
            state.activeCategory = uiStrings.en.allCategory; 
            updateUI();
        };

        const viewThumbnailBtn = document.getElementById('view-thumbnail-btn');
        const viewDetailedBtn = document.getElementById('view-detailed-btn');

        if (viewThumbnailBtn) {
            viewThumbnailBtn.onclick = () => {
                state.viewMode = 'thumbnail';
                saveState('viewMode', 'thumbnail');
                updateUI();
            };
        }
        if (viewDetailedBtn) {
            viewDetailedBtn.onclick = () => {
                state.viewMode = 'detailed';
                saveState('viewMode', 'detailed');
                updateUI();
            };
        }
    }

    function renderSearchBar(strings) {
        searchBarContainer.innerHTML = `
            <div class="mb-8 max-w-full mx-auto">
                <div class="relative group">
                    <div class="absolute inset-0 bg-gradient-to-r from-sky-500/10 to-slate-600/10 dark:from-sky-500/20 dark:to-slate-600/20 rounded-xl blur-lg group-hover:blur-xl transition-all duration-300"></div>
                    <div class="relative bg-white/80 dark:bg-gradient-to-r dark:from-slate-900/95 dark:to-slate-800/95 backdrop-blur-xl border border-black/10 dark:border-white/10 rounded-xl p-1">
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                                <svg class="h-5 w-5 text-slate-500 dark:text-slate-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" /></svg>
                            </div>
                            <input id="search-input" type="search" value="${state.searchTerm}" placeholder="${strings.searchPlaceholder}" class="block w-full pl-11 pr-4 py-3 bg-transparent text-black dark:text-white text-base placeholder-slate-500 dark:placeholder-slate-400 focus:outline-none focus:ring-0 rounded-lg" />
                        </div>
                    </div>
                </div>
            </div>`;
        document.getElementById('search-input').oninput = (e) => {
            state.searchTerm = e.target.value;
            state.currentPage = 1;
            renderMainContent();
        };
    }

    function renderCategoryFilters(strings) {
        const categories = [
            { key: strings.allCategory, name: strings.allCategory },
            { key: strings.favoritesCategory, name: strings.favoritesCategory },
            ...[...new Set(promptsData.map(p => p[`category_${state.language}`]))].sort().map(cat => ({ key: cat, name: cat }))
        ];
        categoryFiltersContainer.innerHTML = categories.map((cat, index) => {
            const isActive = state.activeCategory === cat.key;
            const activeClass = 'bg-sky-500 dark:bg-gradient-to-r dark:from-sky-500 dark:to-slate-600 text-white border-transparent shadow-md shadow-sky-500/25';
            const inactiveClass = 'text-slate-700 dark:text-slate-300 bg-white/50 dark:bg-gradient-to-r dark:from-slate-800/50 dark:to-slate-700/50 border-black/10 dark:border-white/10 hover:border-black/20 dark:hover:border-white/20 hover:text-black dark:hover:text-white backdrop-blur-sm';
            return `
                <button data-category="${cat.key}" style="animation-delay: ${index * 50}ms" class="category-btn animate-fade-in-up px-4 py-2 text-sm font-semibold rounded-xl border transition-all duration-300 transform hover:scale-105 ${isActive ? activeClass : inactiveClass}">
                    ${cat.name}
                </button>`;
        }).join('');
        
        document.querySelectorAll('.category-btn').forEach(btn => {
            btn.onclick = () => {
                state.activeCategory = btn.dataset.category;
                state.currentPage = 1;
                updateUI();
            };
        });
    }
    
    function renderPromptGrid(prompts, strings) {
        if (prompts.length === 0) {
            promptGridContainer.className = ''; // Reset grid classes
            promptGridContainer.innerHTML = `
                <div class="text-center py-24 col-span-full">
                    <div class="relative">
                        <div class="absolute inset-0 bg-gradient-to-r from-purple-400/10 to-pink-400/10 dark:from-purple-400/20 dark:to-pink-400/20 rounded-full filter blur-3xl"></div>
                        <div class="relative bg-white dark:bg-gradient-to-br dark:from-slate-900/90 dark:to-slate-800/90 backdrop-blur-xl border border-gray-200 dark:border-white/10 rounded-3xl p-12 mx-auto max-w-md">
                            <div class="w-20 h-20 mx-auto mb-6 bg-gray-200 dark:bg-gradient-to-r dark:from-slate-700 dark:to-slate-600 rounded-2xl flex items-center justify-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-slate-500 dark:text-slate-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
                            </div>
                            <h3 class="text-2xl font-bold text-slate-800 dark:text-white mb-3">${strings.noResultsTitle}</h3>
                            <p class="text-slate-500 dark:text-slate-400">${strings.noResultsText}</p>
                        </div>
                    </div>
                </div>`;
            return;
        }

        const gridClasses = state.viewMode === 'thumbnail' 
            ? 'grid-cols-3 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5' 
            : 'grid-cols-1 sm:grid-cols-2 lg:grid-cols-3';
        promptGridContainer.className = `grid gap-1 sm:gap-8 ${gridClasses}`;

        promptGridContainer.innerHTML = prompts.map((prompt, index) => {
            const isFavorited = state.favoriteIds.includes(prompt.id);
            const favClass = isFavorited
                ? 'bg-gradient-to-r from-red-500/90 to-pink-500/90 text-white shadow-lg shadow-red-500/25'
                : 'bg-white/40 dark:bg-black/40 text-slate-800 dark:text-white/70 hover:bg-white/60 dark:hover:bg-black/60 hover:text-black dark:hover:text-white';
            
            let contentSectionHTML = '';
            if (state.viewMode === 'detailed') {
                contentSectionHTML = `<div class="card-content-section relative z-10 p-6" data-prompt-id="${prompt.id}"></div>`;
            }

            return `
                <div style="animation-delay: ${index * 100}ms" class="animate-fade-in-up">
                    <div class="prompt-card group relative bg-white dark:bg-gradient-to-br dark:from-slate-900/90 dark:to-slate-800/90 backdrop-blur-xl border border-gray-200 dark:border-white/10 rounded-none sm:rounded-3xl overflow-hidden shadow-lg dark:shadow-2xl cursor-pointer transition-all duration-500 transform sm:hover:scale-[1.02] hover:shadow-xl dark:hover:shadow-3xl dark:hover:shadow-sky-500/10" data-prompt-id="${prompt.id}">
                        <div class="absolute inset-0 bg-gradient-to-br from-sky-500/5 via-slate-500/2 to-pink-500/5 dark:from-sky-500/10 dark:via-slate-500/5 dark:to-pink-500/10 opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                        <div class="relative overflow-hidden aspect-square bg-gray-100 dark:bg-gradient-to-br dark:from-slate-900 dark:to-slate-800">
                            <img src="${prompt.image}" alt="Generated image" class="w-full h-full object-cover transition-all duration-700 group-hover:scale-110 group-hover:brightness-105 dark:group-hover:brightness-110" loading="lazy" />
                            <div class="absolute inset-0 bg-gradient-to-t from-black/40 dark:from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                            
                            <button class="favorite-btn absolute top-2 right-2 p-2 backdrop-blur-xl rounded-full border border-white/10 transition-all duration-300 transform hover:scale-110 ${favClass}" data-prompt-id="${prompt.id}">
                                <svg class="w-4 h-4 pointer-events-none" fill="currentColor" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" /></svg>
                            </button>

                            <button class="quick-copy-btn absolute bottom-2 right-2 p-2 bg-sky-500 dark:bg-gradient-to-r dark:from-sky-500/90 dark:to-slate-600/90 text-white backdrop-blur-xl rounded-full border border-white/20 transition-all duration-300 transform shadow-lg shadow-sky-500/25 translate-y-4 opacity-0 group-hover:translate-y-0 group-hover:opacity-100" data-prompt-id="${prompt.id}">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 pointer-events-none" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>
                            </button>
                        </div>
                        ${contentSectionHTML}
                    </div>
                </div>`;
        }).join('');

        // Add event listeners
        document.querySelectorAll('.prompt-card').forEach(card => {
            const promptId = parseInt(card.dataset.promptId);
            const prompt = promptsData.find(p => p.id === promptId);
            
            if (state.viewMode === 'detailed') {
                 const contentSection = card.querySelector('.card-content-section');
                let contentRendered = false;

                const renderCardContent = (promptLang) => {
                    if (!prompt || !contentSection) return;
                    const currentPromptText = promptLang === 'id' ? prompt.prompt_id : prompt.prompt_en;
                    const idClass = promptLang === 'id' ? 'bg-sky-500 dark:bg-gradient-to-r dark:from-sky-500 dark:to-slate-600 text-white shadow-md' : 'text-slate-600 dark:text-slate-400 hover:text-black dark:hover:text-white';
                    const enClass = promptLang === 'en' ? 'bg-sky-500 dark:bg-gradient-to-r dark:from-sky-500 dark:to-slate-600 text-white shadow-md' : 'text-slate-600 dark:text-slate-400 hover:text-black dark:hover:text-white';
                    
                    contentSection.innerHTML = `
                        <div class="flex mb-4 bg-gray-200/80 dark:bg-slate-800/50 rounded-2xl p-1 border border-black/10 dark:border-white/10">
                            <button class="card-lang-btn flex-1 py-2 text-sm text-center rounded-xl transition-all duration-300 ${idClass}" data-lang="id">Indonesia</button>
                            <button class="card-lang-btn flex-1 py-2 text-sm text-center rounded-xl transition-all duration-300 ${enClass}" data-lang="en">English</button>
                        </div>
                        <div class="relative bg-gray-100/80 dark:bg-gradient-to-br dark:from-slate-900/70 dark:to-slate-800/70 rounded-2xl p-4 mb-6 border border-black/5 dark:border-white/5 backdrop-blur-sm">
                            <div class="prompt-text text-slate-700 dark:text-slate-300 text-sm leading-relaxed h-24 overflow-y-auto scrollbar-thin">${currentPromptText}</div>
                            <button class="card-copy-textarea-btn absolute top-3 right-3 p-2 text-slate-500 dark:text-slate-400 hover:text-black dark:hover:text-white bg-gray-200/50 dark:bg-slate-800/50 rounded-lg hover:bg-gray-300/50 dark:hover:bg-slate-700/50 transition-all duration-200">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 pointer-events-none" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>
                            </button>
                        </div>
                        <button class="card-copy-main-btn w-full bg-gradient-to-r from-sky-500 to-slate-600 text-white font-semibold py-3 px-6 rounded-2xl hover:from-sky-600 hover:to-slate-700 transition-all duration-300 transform hover:scale-[1.02] shadow-lg shadow-sky-500/25 flex items-center justify-center gap-3">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 pointer-events-none" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2h-2M8 5a2 2 0 012-2h4a2 2 0 012 2v0M8 5a2 2 0 002 2h4a2 2 0 002-2v0" /></svg>
                            ${strings.copyBtn}
                        </button>`;
                    
                    contentSection.querySelectorAll('.card-lang-btn').forEach(btn => {
                        btn.onclick = (e) => {
                            e.stopPropagation();
                            renderCardContent(btn.dataset.lang);
                        };
                    });
                     contentSection.querySelectorAll('.card-copy-textarea-btn, .card-copy-main-btn').forEach(btn => {
                        btn.onclick = (e) => {
                            e.stopPropagation();
                            const text = contentSection.querySelector('.prompt-text').textContent;
                            handleCopyToClipboard(text, strings);
                        };
                    });

                };

                const ensureContentRendered = () => {
                    if (!contentRendered) {
                        renderCardContent(state.language);
                        contentRendered = true;
                    }
                };

                if (window.matchMedia('(hover: hover)').matches) {
                    card.addEventListener('mouseenter', ensureContentRendered, { once: true });
                }
                
                card.addEventListener('touchstart', ensureContentRendered, { once: true, passive: true });
            }
            
            card.onclick = () => {
                state.selectedPrompt = prompt;
                renderModal(getFilteredPrompts());
            };
            
            card.querySelector('.favorite-btn').onclick = (e) => {
                e.stopPropagation();
                const newFavorites = state.favoriteIds.includes(promptId) 
                    ? state.favoriteIds.filter(id => id !== promptId)
                    : [...state.favoriteIds, promptId];
                state.favoriteIds = newFavorites;
                saveState('favoritePromptIds', newFavorites);
                renderMainContent(); 
            };

            card.querySelector('.quick-copy-btn').onclick = (e) => {
                e.stopPropagation();
                const text = state.language === 'id' ? prompt.prompt_id : prompt.prompt_en;
                handleCopyToClipboard(text, strings);
            };
        });
    }

    function renderPagination(totalPages, currentPage) {
        if (totalPages <= 1) {
            paginationContainer.innerHTML = '';
            return;
        }

        paginationContainer.innerHTML = `
            <div class="bg-white/80 dark:bg-gradient-to-r dark:from-slate-900/90 dark:to-slate-800/90 backdrop-blur-xl border border-black/10 dark:border-white/10 rounded-2xl p-2 flex items-center gap-4">
                <button id="prev-page-btn" ${currentPage <= 1 ? 'disabled' : ''} class="flex items-center gap-2 px-6 py-3 text-sm font-semibold text-slate-800 dark:text-white bg-gray-100 dark:bg-gradient-to-r dark:from-slate-700/50 dark:to-slate-600/50 border border-black/10 dark:border-white/10 rounded-xl hover:bg-gray-200 dark:hover:from-slate-600/50 dark:hover:to-slate-500/50 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 transform hover:scale-105">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" /></svg>
                    Previous
                </button>
                <div class="flex items-center gap-3 text-sm font-medium text-slate-600 dark:text-slate-300">
                    <span>Page</span>
                    <input id="page-input" type="number" value="${currentPage}" min="1" max="${totalPages}" class="w-20 p-2 text-center text-black dark:text-white bg-gray-50 dark:bg-gradient-to-r dark:from-slate-800 dark:to-slate-700 border border-black/10 dark:border-white/10 rounded-xl focus:outline-none focus:ring-2 focus:ring-sky-500/50 focus:border-sky-500/50 transition-all" />
                    <span>of ${totalPages}</span>
                </div>
                <button id="next-page-btn" ${currentPage >= totalPages ? 'disabled' : ''} class="flex items-center gap-2 px-6 py-3 text-sm font-semibold text-slate-800 dark:text-white bg-gray-100 dark:bg-gradient-to-r dark:from-slate-700/50 dark:to-slate-600/50 border border-black/10 dark:border-white/10 rounded-xl hover:bg-gray-200 dark:hover:from-slate-600/50 dark:hover:to-slate-500/50 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 transform hover:scale-105">
                    Next
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" /></svg>
                </button>
            </div>`;
        
        const changePage = (newPage) => {
            if (newPage > 0 && newPage <= totalPages) {
                state.currentPage = newPage;
                window.scrollTo({ top: 0, behavior: 'smooth' });
                renderMainContent();
            }
        };
        
        document.getElementById('prev-page-btn').onclick = () => changePage(state.currentPage - 1);
        document.getElementById('next-page-btn').onclick = () => changePage(state.currentPage + 1);
        
        const pageInput = document.getElementById('page-input');
        
        const commitPageChange = () => {
             const pageNumber = parseInt(pageInput.value, 10);
             if (!isNaN(pageNumber) && pageNumber >= 1 && pageNumber <= totalPages) {
                 changePage(pageNumber);
             } else {
                 pageInput.value = state.currentPage; 
             }
        };

        pageInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                commitPageChange();
                e.target.blur();
            }
        });
        pageInput.addEventListener('blur', commitPageChange);
    }
    
    function renderModal(filteredPrompts) {
        if (!state.selectedPrompt) {
            modalContainer.innerHTML = '';
            document.body.style.overflow = 'unset';
            return;
        }

        document.body.style.overflow = 'hidden';
        
        let modalState = {
            lang: state.language
        };

        const updateModalContent = () => {
            const prompt = state.selectedPrompt;
            if(!prompt) return;

            const strings = uiStrings[modalState.lang];
            const promptText = modalState.lang === 'id' ? prompt.prompt_id : prompt.prompt_en;
            const tags = modalState.lang === 'id' ? prompt.tags_id : prompt.tags_en;
            const hasNavigation = filteredPrompts.length > 1;

            const idClass = modalState.lang === 'id' ? 'bg-sky-500 text-white' : 'text-slate-400';
            const enClass = modalState.lang === 'en' ? 'bg-sky-500 text-white' : 'text-slate-400';

            modalContainer.innerHTML = `
                <div id="modal-backdrop" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
                    <button id="modal-close-btn" class="absolute top-4 right-4 text-white bg-black/50 rounded-full p-2 hover:bg-black/75 transition-all z-[60]">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                    <div id="modal-content" class="bg-slate-900/95 border border-slate-700/50 rounded-2xl shadow-2xl w-full max-w-sm max-h-[85vh] flex flex-col overflow-hidden">
                        <div class="flex-shrink-0 relative">
                            <img src="${prompt.image}" alt="Generated image" class="w-full h-auto object-contain rounded-t-2xl" />
                            ${hasNavigation ? `
                                <button id="modal-prev-btn" class="absolute left-3 top-1/2 -translate-y-1/2 p-2 bg-black/40 backdrop-blur-sm rounded-full text-white hover:bg-black/60 transition-all">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" /></svg>
                                </button>
                                <button id="modal-next-btn" class="absolute right-3 top-1/2 -translate-y-1/2 p-2 bg-black/40 backdrop-blur-sm rounded-full text-white hover:bg-black/60 transition-all">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" /></svg>
                                </button>
                            ` : ''}
                        </div>
                        <div class="p-4 sm:p-6 flex flex-col overflow-y-auto flex-grow">
                            <div class="flex flex-wrap gap-2 mb-4">
                                ${tags.map(tag => `<span class="bg-slate-700 text-slate-300 text-xs font-medium px-2.5 py-1 rounded-full">#${tag}</span>`).join('')}
                            </div>
                            <div class="relative bg-slate-800 border border-slate-700 rounded-xl p-4 flex-grow mb-4">
                                <div class="text-slate-300 text-sm leading-relaxed overflow-y-auto h-24 scrollbar-thin">${promptText}</div>
                            </div>
                             <div class="flex items-center gap-2">
                                <div class="bg-slate-800 border border-slate-700 p-1 rounded-xl flex-shrink-0">
                                    <div class="flex space-x-1">
                                        <button id="modal-lang-id" class="px-3 py-1 text-xs font-semibold rounded-lg transition-colors ${idClass}">ID</button>
                                        <button id="modal-lang-en" class="px-3 py-1 text-xs font-semibold rounded-lg transition-colors ${enClass}">EN</button>
                                    </div>
                                </div>
                                <button id="modal-copy-btn" class="w-full bg-sky-500 text-white font-semibold py-2 px-4 rounded-xl hover:bg-sky-600 transition-all flex items-center justify-center gap-2">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>
                                    <span>${strings.copyBtn}</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // Re-attach event listeners for modal content
            document.getElementById('modal-lang-id').onclick = () => { modalState.lang = 'id'; updateModalContent(); };
            document.getElementById('modal-lang-en').onclick = () => { modalState.lang = 'en'; updateModalContent(); };
            document.getElementById('modal-copy-btn').onclick = () => handleCopyToClipboard(promptText, uiStrings[modalState.lang]);
            document.getElementById('modal-backdrop').onclick = closeModal;
            document.getElementById('modal-close-btn').onclick = closeModal;
            document.getElementById('modal-content').onclick = (e) => e.stopPropagation();
            if (hasNavigation) {
                document.getElementById('modal-next-btn').onclick = (e) => {e.stopPropagation(); navigate(1);};
                document.getElementById('modal-prev-btn').onclick = (e) => {e.stopPropagation(); navigate(-1);};
            }
        };

        const closeModal = () => {
            state.selectedPrompt = null;
            renderModal(filteredPrompts);
        };
        
        const navigate = (direction) => {
            const hasNav = filteredPrompts.length > 1;
            if (!state.selectedPrompt || !hasNav) return;
            const currentIndex = filteredPrompts.findIndex(p => p.id === state.selectedPrompt.id);
            if (currentIndex === -1) return;
            const newIndex = (currentIndex + direction + filteredPrompts.length) % filteredPrompts.length;
            state.selectedPrompt = filteredPrompts[newIndex];
            updateModalContent();
        };

        const handleKeyDown = (e) => {
            if (e.key === 'Escape') closeModal();
            if (e.key === 'ArrowRight') navigate(1);
            if (e.key === 'ArrowLeft') navigate(-1);
        };
        
        window.addEventListener('keydown', handleKeyDown);
        modalContainer.addEventListener('DOMNodeRemoved', () => {
             window.removeEventListener('keydown', handleKeyDown);
        });

        updateModalContent();
    }


    function renderToast() {
        const isVisibleClass = state.isToastVisible ? 'opacity-100 translate-y-0 scale-100' : 'opacity-0 translate-y-8 scale-95';
        toastContainer.innerHTML = `
            <div class="fixed bottom-8 left-1/2 -translate-x-1/2 bg-gradient-to-r from-emerald-500 to-green-500 text-white font-semibold px-8 py-4 rounded-2xl shadow-2xl transition-all duration-500 transform border border-emerald-400/30 backdrop-blur-xl ${isVisibleClass}">
                <div class="flex items-center gap-3">
                    <div class="w-6 h-6 bg-white/20 rounded-full flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>
                    </div>
                    ${state.toastMessage}
                </div>
            </div>`;
    }
    
    // --- MAIN RENDER LOGIC ---
    function renderMainContent() {
        const filteredPrompts = getFilteredPrompts();
        const totalPages = Math.ceil(filteredPrompts.length / ITEMS_PER_PAGE);
        const promptsToDisplay = filteredPrompts.slice((state.currentPage - 1) * ITEMS_PER_PAGE, state.currentPage * ITEMS_PER_PAGE);

        renderPromptGrid(promptsToDisplay, uiStrings[state.language]);
        renderPagination(totalPages, state.currentPage);

    }

    function updateUI() {
        // Apply theme first
        document.documentElement.classList.add('dark');
        backgroundElements.innerHTML = `
            <div class="absolute -top-40 -right-40 w-96 h-96 bg-gradient-to-r from-blue-400/10 to-purple-400/10 rounded-full mix-blend-multiply filter blur-xl animate-pulse"></div>
            <div class="absolute -bottom-40 -left-40 w-96 h-96 bg-gradient-to-r from-purple-400/10 to-pink-400/10 rounded-full mix-blend-multiply filter blur-xl animate-pulse animation-delay-2000"></div>
            <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-gradient-to-r from-indigo-400/5 to-cyan-400/5 rounded-full mix-blend-multiply filter blur-3xl animate-pulse animation-delay-4000"></div>
        `;
        
        const strings = uiStrings[state.language];
        document.documentElement.lang = state.language;
        document.title = strings.pageTitle;

        renderHeader(strings);
        renderSearchBar(strings);
        renderCategoryFilters(strings);
        renderMainContent();
    }

    // --- INITIALIZATION ---
    loadState();
    updateUI();
});
</script>
</body>
</html>

